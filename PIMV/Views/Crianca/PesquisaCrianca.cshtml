@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    var db = WebMatrix.Data.Database.Open("dbBancoPIM");

    var crianca = db.Query(@"select c.idMatricula 'Matricula', c.dtNascimento 'dtNasc' , c.dtMatricula 'dtMatricula', r.nome 'nomeResp', c.nome 'nomeCrianca', s.nome 'nomeSala', t.periodo 'nomePeriodo', c.sexo 'sexo', c.Observacoes 'obs'
                             from Crianca c left join Responsavel r
                             on c.cpfResponsavel = r.cpf left join Sala s
                             on c.idSala = s.idSala left join Turma t
                             on c.idTurma = t.idTurma");
    db.Close();
}


<body>
    <div class="row">

        <div class="col-md-1"></div>
        <div class="col-md-11">
            <h3 class="text-primary">Pesquisar Criança</h3>
            <hr />
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th class="text-center">Matrícula</th>
                        <th class="text-center">Nome</th>
                        <th class="text-center">Sala</th>
                        <th class="text-center">Turma</th>
                        <th class="text-center">Responsável</th>
                        <th class="text-center">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var c in crianca)
                    {
                        <tr class="text-center">
                            <td>@c.Matricula</td>
                            <td>@c.nomeCrianca</td>
                            <td>@c.nomeSala</td>
                            <td>@c.nomePeriodo</td>
                            <td>@c.nomeResp</td>
                            <td>
                                <button type="button" class="btn btn-warning"
                                        data-idMat="@c.Matricula"
                                        data-dataMat="@c.dtMatricula"
                                        data-nmResp="@c.nomeResp"
                                        data-nmCrianca="@c.nomeCrianca"
                                        data-sexo="@c.sexo"
                                        data-dataNasc="@c.dtNasc"
                                        data-obs="@c.obs"
                                        data-toggle="modal" data-target="#myModal" >
                                    Editar
                                </button>
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="Visualizar"> Visualizar</button>
                                <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#exampleModal" data-whatever="Excluir">Excluir</button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

            <!--Ficha crianca-->
            <!-- Modal -->
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>

                            <h4 class="modal-title text-center" id="myModalLabel">Ficha da Criança
                            </h4>
                        </div>

                        <div class="modal-body">
                            <form method="post" action="">
                                <div class="row">
                                    <div class="col-md-5">

                                        <div class="form-group">
                                            <label for="txtMatricula"> Nº da Matrícula: </label>
                                            <input type="text" name="textIdMat" class="form-control btn-block" readonly="readonly" />
                                        </div>
                                    </div>

                                    <div class="col-md-2"></div>
                                    <div class="col-md-5">
                                        <div class="form-group">
                                            <label for="dtMatricula">Data da Matrícula:</label>
                                            <input type="date" name="dataMat" class="form-control btn-block" readonly="readonly" />
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="textResp">Responsável:</label>
                                            <input type="text" name="nmResp" class="form-control" readonly="readonly"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="textNome">Nome:</label>
                                            <input type="text" name="nmCrianca" class="form-control" />
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-5">
                                        <div class="form-group">
                                            <label for="dtNascimento">Data de Nascimento:</label>
                                            <input type="text" name="dataNasc" class="form-control" />
                                        </div>
                                    </div>

                                    <div class="col-md-2"></div>
                                    <div class="col-md-5">
                                        <div class="form-group">
                                            <label for="rSexo">Sexo:</label>
                                            <p></p>
                                            <!-- lembrar de marcar o sexo -->
                                            <label class="radio-inline"><input type="radio" value="M" name="opSexo">Masculino</label>
                                            <label class="radio-inline"><input type="radio" value="F" name="opSexo">Feminino</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="taObs">Observações:</label>
                                            <textarea name="taObs" class="form-control" style="width:565px; height:200px"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-success">Salvar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @section Scripts {
        <script>

            $('#myModal').on('shown.bs.modal', function (event) {
                var button = $(event.relatedTarget)
                var idMat = button.data('idmat')
                var dataMat = button.data('datamat')
                var nmResp = button.data('nmresp')
                var nmCrianca = button.data('nmcrianca')
                var dataNasc = button.data('datanasc')
                var opSexo = button.data('sexo')
                var obs = button.data('obs')

                console.log('idMat', idMat)

                var modal = $(this)

                console.log(
                    modal.find('.modal-body input[name=textIdMat]')
                )

                modal.find('.modal-body input[name=textIdMat]').val(idMat)
                modal.find('.modal-body input[name=dataMat]').val(dataMat)
                modal.find('.modal-body input[name=nmResp]').val(nmResp)
                modal.find('.modal-body input[name=textNmCrianca]').val(nmCrianca)
                modal.find('.modal-body input[name=dataNasc]').val(dataNasc)
                modal.find('.modal-body input[name=opSexo]').val(opSexo)
                modal.find('.modal-body input[name=taObs]').val(obs)
            });

        </script>
    }

</body>